*#define CHECK

#if 0
* huuSM-SquaredME.F
* assembly of squared matrix element
* generated by FormCalc 9.6 (7 Mar 2018) on 13-Mar-2018 8:19
* this file is part of FeynHiggs
#endif

#include "huuSM-vars.h"
#include "inline.h"

************************************************************************

	subroutine huuSM_SquaredMEHel(res)
	implicit none
	RealType res(*)

#include "huuSM-vars.h"

	ComplexType amp
	RealType ampsq

* huuSM-BEGIN ABBR_HEL
	call huuSM_abbr0h
	call huuSM_abbr1h
* huuSM-END ABBR_HEL

	ampsq = 0
* huuSM-BEGIN FF_TREE
	Ctree(1) = 0

	call huuSM_v0
* huuSM-END FF_TREE

* huuSM-BEGIN M2_TREE
	amp = 0
	amp = amp + Ctree(1)*MatSUN(1,1)
	ampsq = ampsq + Re(amp*Conjugate(Ctree(1)))
* huuSM-END M2_TREE
	res(1) = ampsq

	ampsq = 0
* huuSM-BEGIN FF_LOOP
	Cloop(1) = 0

	call huuSM_v1

	LOOP(Gen4, 1,3,1)
	call huuSM_v1_Gen4
	ENDLOOP(Gen4)
* huuSM-END FF_LOOP

* huuSM-BEGIN M2_LOOP
	amp = 0
	amp = amp + Cloop(1)*MatSUN(1,1)
	ampsq = ampsq + Re(amp*Conjugate(Ctree(1)))
	ampsq = ampsq + ampsq
	amp = 0
	amp = amp + Cloop(1)*MatSUN(1,1)
	ampsq = ampsq + Re(amp*Conjugate(Cloop(1)))
* huuSM-END M2_LOOP
	res(2) = ampsq

	end

************************************************************************

	subroutine huuSM_SquaredME(result)
	implicit none
	RealType result(*)

#include "huuSM-vars.h"

* huuSM-BEGIN VAR_DECL
	integer i, h, hmax
	parameter (hmax = 2)
	RealType res(2,hmax)
	RealType rtree, rloop
	external huuSM_SquaredMEHel
* huuSM-END VAR_DECL

	data MatSUN /NaN(1)/

#include "inline.h"

* huuSM-BEGIN INVARIANTS
* huuSM-END INVARIANTS

* huuSM-BEGIN ABBR_S
	call huuSM_abbr0s
	call huuSM_abbr1s
* huuSM-END ABBR_S

* huuSM-BEGIN ABBR_ANGLE
* huuSM-END ABBR_ANGLE

* huuSM-BEGIN HEL_LOOP

	h = 0
	do i = 0, hmax - 1

#define hval(s,m,a,b) a*mod(i/s,m)-b

	  Hel0(1) = 0
	  Hel0(2) = hval(1,2,2,1)
	  Hel0(3) = Hel0(2)
	  h = h + 1
	  call huuSM_SquaredMEHel(res(1,h))
	enddo

* huuSM-END HEL_LOOP

* huuSM-BEGIN RESULT
	rtree = 0
	rloop = 0
	do i = 1, h
	  rtree = rtree + res(1,i)
	  rloop = rloop + res(2,i)
	enddo
	result(1) = rtree
	result(2) = rloop

* huuSM-END RESULT

#ifdef CHECK
	print *, 'tree =', rtree
	print *, 'loop =', rloop
	stop
#endif

	end

