#include "intfile.hh"

dcmplx Pf4(const double x[], double es[], double esx[], double em[], double lambda, double lrs[], double bi) {
double x0=x[0];
double x1=x[1];
double x2=x[2];
dcmplx y[98];
dcmplx FOUT;
dcmplx MYI(0.,1.);
y[1]=1./bi;
y[2]=em[0];
y[3]=esx[0];
y[4]=-x0;
y[5]=1.+y[4];
y[6]=2.*y[1]*y[2];
y[7]=2.*x0*y[1]*y[2];
y[8]=-(y[1]*y[3]);
y[9]=lrs[0];
y[10]=2.*x1*y[1]*y[2];
y[11]=2.*x0*x1*y[1]*y[2];
y[12]=-(x1*y[1]*y[3]);
y[13]=y[6]+y[7]+y[8]+y[10]+y[11]+y[12];
y[14]=-(lambda*MYI*y[5]*y[9]*y[13]);
y[15]=-x1;
y[16]=1.+y[15];
y[17]=lrs[1];
y[18]=y[1]*y[2];
y[19]=x0*x0;
y[20]=y[1]*y[2]*y[19];
y[21]=-(x0*y[1]*y[3]);
y[22]=y[7]+y[18]+y[20]+y[21];
y[23]=-(lambda*MYI*x0*y[5]*y[9]*y[13]);
y[24]=x0+y[23];
y[25]=-(lambda*MYI*x1*y[16]*y[17]*y[22]);
y[26]=x1+y[25];
y[27]=pow(y[24],2);
y[28]=pow(bi,-2);
y[29]=1.+y[14];
y[30]=lambda*lambda;
y[31]=y[6]+y[7]+y[8];
y[32]=pow(y[31],2);
y[33]=x0*x1*y[5]*y[9]*y[16]*y[17]*y[30]*y[32];
y[34]=y[6]+y[10];
y[35]=-(lambda*MYI*x0*y[5]*y[9]*y[34]);
y[36]=lambda*MYI*x0*y[9]*y[13];
y[37]=1.+y[14]+y[35]+y[36];
y[38]=-(lambda*MYI*y[16]*y[17]*y[22]);
y[39]=lambda*MYI*x1*y[17]*y[22];
y[40]=1.+y[38]+y[39];
y[41]=y[37]*y[40];
y[42]=y[33]+y[41];
y[43]=y[1]*y[24];
y[44]=y[1]*y[26];
y[45]=y[1]*y[24]*y[26];
y[46]=y[1]+y[43]+y[44]+y[45];
y[47]=1./y[46];
y[48]=2.*y[1]*y[2]*y[24];
y[49]=-(y[1]*y[3]*y[24]);
y[50]=y[1]*y[2]*y[27];
y[51]=y[1]*y[2]*y[26];
y[52]=2.*y[1]*y[2]*y[24]*y[26];
y[53]=-(y[1]*y[3]*y[24]*y[26]);
y[54]=y[1]*y[2]*y[26]*y[27];
y[55]=y[18]+y[48]+y[49]+y[50]+y[51]+y[52]+y[53]+y[54];
y[56]=1./y[55];
y[57]=x1*x1;
y[58]=1./x2;
y[59]=y[1]*y[2]*y[57];
y[60]=x0*y[1]*y[2]*y[57];
y[61]=lrs[2];
y[62]=-x2;
y[63]=1.+y[62];
y[64]=2.*x1*x2*y[1]*y[2];
y[65]=4.*x1*x2*y[1]*y[2];
y[66]=y[6]+y[7]+y[8]+y[10]+y[11]+y[65];
y[67]=x2*y[1]*y[2]*y[57];
y[68]=y[6]+y[7]+y[8]+y[10]+y[11]+y[12]+y[64]+y[67];
y[69]=-(lambda*MYI*y[5]*y[9]*y[68]);
y[70]=y[10]+y[59];
y[71]=2.*x2*y[1]*y[2];
y[72]=y[6]+y[7]+y[8]+y[64]+y[71];
y[73]=2.*x0*x2*y[1]*y[2];
y[74]=x2*x2;
y[75]=2.*x0*x1*x2*y[1]*y[2];
y[76]=2.*x1*y[1]*y[2]*y[74];
y[77]=-(x2*y[1]*y[3]);
y[78]=y[7]+y[18]+y[20]+y[21]+y[64]+y[71]+y[73]+y[75]+y[76]+y[77];
y[79]=lambda*MYI*x0*y[9]*y[68];
y[80]=1.+y[35]+y[69]+y[79];
y[81]=2.*y[1]*y[2]*y[74];
y[82]=y[71]+y[73]+y[81];
y[83]=-(lambda*MYI*x1*y[16]*y[17]*y[82]);
y[84]=-(lambda*MYI*y[16]*y[17]*y[78]);
y[85]=lambda*MYI*x1*y[17]*y[78];
y[86]=1.+y[83]+y[84]+y[85];
y[87]=2.*x2*y[1]*y[2]*y[57];
y[88]=y[10]+y[11]+y[12]+y[59]+y[60]+y[87];
y[89]=-(lambda*MYI*y[61]*y[63]*y[88]);
y[90]=-(lambda*MYI*x0*y[5]*y[9]*y[68]);
y[91]=x0+y[90];
y[92]=-(lambda*MYI*x1*y[16]*y[17]*y[78]);
y[93]=x1+y[92];
y[94]=pow(y[91],2);
y[95]=-(lambda*MYI*x2*y[61]*y[63]*y[88]);
y[96]=x2+y[95];
y[97]=pow(y[93],2);
FOUT=x0*(myLog(bi)*y[28]*y[29]*y[42]*y[47]*y[56]+3.*myLog(y[46])*y[28]*y[29]\
*y[42]*y[47]*y[56]-2.*myLog(y[55])*y[28]*y[29]*y[42]*y[47]*y[56]+myLog(1.-l\
ambda*MYI*(y[10]+y[11]+y[12]+y[59]+y[60])*y[61])*y[28]*y[29]*y[42]*y[47]*y[\
56])-x0*y[28]*y[29]*y[42]*y[47]*y[56]*y[58]+(x0*y[28]*y[58]*(1.+y[69])*(lam\
bda*MYI*x2*y[61]*y[63]*y[66]*(x0*x1*y[5]*y[9]*y[16]*y[17]*y[30]*y[70]*y[72]\
-lambda*MYI*x1*y[16]*y[17]*y[66]*y[80])-lambda*MYI*x2*y[61]*y[63]*y[70]*(-(\
x0*x1*y[5]*y[9]*y[16]*y[17]*y[30]*y[66]*y[72])+lambda*MYI*x0*y[5]*y[9]*y[70\
]*y[86])+(x0*x1*pow(y[72],2)*y[5]*y[9]*y[16]*y[17]*y[30]+y[80]*y[86])*(1.-2\
.*lambda*MYI*x2*y[1]*y[2]*y[57]*y[61]*y[63]+lambda*MYI*x2*y[61]*y[88]+y[89]\
)))/((1.+y[89])*(y[1]+y[1]*y[91]+y[1]*y[93]+y[1]*y[91]*y[93]+y[1]*y[93]*y[9\
6])*(y[18]+2.*y[1]*y[2]*y[91]-y[1]*y[3]*y[91]+y[1]*y[2]*y[93]+2.*y[1]*y[2]*\
y[91]*y[93]-y[1]*y[3]*y[91]*y[93]+y[1]*y[2]*y[94]+y[1]*y[2]*y[93]*y[94]+2.*\
y[1]*y[2]*y[93]*y[96]-y[1]*y[3]*y[93]*y[96]+2.*y[1]*y[2]*y[91]*y[93]*y[96]+\
pow(y[96],2)*y[1]*y[2]*y[97]+y[1]*y[2]*y[96]*y[97]+y[1]*y[2]*y[91]*y[96]*y[\
97]));
return (FOUT);
}
