#include "intfile.hh"

dcmplx Pf2(const double x[], double es[], double esx[], double em[], double lambda, double lrs[], double bi) {
double x0=x[0];
double x1=x[1];
double x2=x[2];
dcmplx y[138];
dcmplx FOUT;
dcmplx MYI(0.,1.);
y[1]=pow(bi,-2);
y[2]=-x0;
y[3]=1.+y[2];
y[4]=em[0];
y[5]=1./bi;
y[6]=lrs[0];
y[7]=y[4]*y[5];
y[8]=x1*y[4]*y[5];
y[9]=esx[0];
y[10]=-(y[5]*y[9]);
y[11]=y[7]+y[8]+y[10];
y[12]=-x1;
y[13]=1.+y[12];
y[14]=lrs[1];
y[15]=x0*y[4]*y[5];
y[16]=y[7]+y[15];
y[17]=-(lambda*MYI*x0*y[3]*y[6]*y[11]);
y[18]=x0+y[17];
y[19]=-(lambda*MYI*x1*y[13]*y[14]*y[16]);
y[20]=x1+y[19];
y[21]=myLog(x1);
y[22]=1./x2;
y[23]=lambda*lambda;
y[24]=pow(y[4],2);
y[25]=x0*x1*y[1]*y[3]*y[6]*y[13]*y[14]*y[23]*y[24];
y[26]=-(lambda*MYI*y[3]*y[6]*y[11]);
y[27]=lambda*MYI*x0*y[6]*y[11];
y[28]=1.+y[26]+y[27];
y[29]=-(lambda*MYI*y[13]*y[14]*y[16]);
y[30]=lambda*MYI*x1*y[14]*y[16];
y[31]=1.+y[29]+y[30];
y[32]=y[28]*y[31];
y[33]=y[25]+y[32];
y[34]=y[5]*y[18];
y[35]=y[5]*y[20];
y[36]=y[5]*y[18]*y[20];
y[37]=y[5]+y[34]+y[35]+y[36];
y[38]=pow(y[37],-2);
y[39]=x0*x0;
y[40]=myLog(bi);
y[41]=y[1]*y[33]*y[38]*y[40];
y[42]=1.+y[29];
y[43]=myLog(y[42]);
y[44]=-(y[1]*y[33]*y[38]*y[43]);
y[45]=myLog(y[37]);
y[46]=3.*y[1]*y[33]*y[38]*y[45];
y[47]=y[4]*y[5]*y[18];
y[48]=-(y[5]*y[9]*y[18]);
y[49]=y[4]*y[5]*y[20];
y[50]=y[4]*y[5]*y[18]*y[20];
y[51]=y[7]+y[10]+y[47]+y[48]+y[49]+y[50];
y[52]=myLog(y[51]);
y[53]=-2.*y[1]*y[33]*y[38]*y[52];
y[54]=y[4]*y[5]*y[39];
y[55]=2.*x0*x1*y[4]*y[5];
y[56]=x1*y[4]*y[5]*y[39];
y[57]=-(x0*x1*y[5]*y[9]);
y[58]=y[15]+y[54]+y[55]+y[56]+y[57];
y[59]=lrs[2];
y[60]=-(lambda*MYI*y[58]*y[59]);
y[61]=1.+y[60];
y[62]=myLog(y[61]);
y[63]=y[1]*y[33]*y[38]*y[62];
y[64]=y[41]+y[44]+y[46]+y[53]+y[63];
y[65]=y[1]*y[40];
y[66]=-(y[1]*y[43]);
y[67]=myLog(x2);
y[68]=-x2;
y[69]=1.+y[68];
y[70]=2.*x0*y[4]*y[5];
y[71]=2.*x2*y[4]*y[5]*y[39];
y[72]=-(x0*y[5]*y[9]);
y[73]=y[54]+y[70]+y[71]+y[72];
y[74]=2.*x2*y[4]*y[5];
y[75]=x2*x2;
y[76]=2.*x0*x2*y[4]*y[5];
y[77]=2.*x1*x2*y[4]*y[5];
y[78]=x2*y[4]*y[5];
y[79]=2.*x0*x1*x2*y[4]*y[5];
y[80]=2.*x0*x1*y[4]*y[5]*y[75];
y[81]=-(x1*x2*y[5]*y[9]);
y[82]=y[7]+y[8]+y[10]+y[76]+y[77]+y[78]+y[79]+y[80]+y[81];
y[83]=2.*x1*y[4]*y[5];
y[84]=4.*x0*x1*x2*y[4]*y[5];
y[85]=-(x1*y[5]*y[9]);
y[86]=y[7]+y[55]+y[70]+y[83]+y[84]+y[85];
y[87]=2.*x0*y[4]*y[5]*y[75];
y[88]=-(x2*y[5]*y[9]);
y[89]=y[7]+y[74]+y[76]+y[87]+y[88];
y[90]=x2*y[4]*y[5]*y[39];
y[91]=y[4]*y[5]*y[39]*y[75];
y[92]=-(x0*x2*y[5]*y[9]);
y[93]=y[7]+y[15]+y[76]+y[90]+y[91]+y[92];
y[94]=2.*x1*y[4]*y[5]*y[75];
y[95]=y[74]+y[77]+y[94];
y[96]=-(lambda*MYI*x0*y[3]*y[6]*y[95]);
y[97]=-(lambda*MYI*y[3]*y[6]*y[82]);
y[98]=lambda*MYI*x0*y[6]*y[82];
y[99]=1.+y[96]+y[97]+y[98];
y[100]=-(lambda*MYI*y[13]*y[14]*y[93]);
y[101]=lambda*MYI*x1*y[14]*y[93];
y[102]=1.+y[100]+y[101];
y[103]=2.*x1*x2*y[4]*y[5]*y[39];
y[104]=y[15]+y[54]+y[55]+y[56]+y[57]+y[103];
y[105]=-(lambda*MYI*y[59]*y[69]*y[104]);
y[106]=-(lambda*MYI*x0*y[3]*y[6]*y[82]);
y[107]=x0+y[106];
y[108]=-(lambda*MYI*x1*y[13]*y[14]*y[93]);
y[109]=x1+y[108];
y[110]=1.+y[105];
y[111]=1./y[110];
y[112]=x0*x1*y[3]*y[6]*y[13]*y[14]*y[23]*y[86]*y[89];
y[113]=-(lambda*MYI*x1*y[13]*y[14]*y[73]*y[99]);
y[114]=y[112]+y[113];
y[115]=lambda*MYI*x2*y[59]*y[69]*y[73]*y[114];
y[116]=-(x0*x1*y[3]*y[6]*y[13]*y[14]*y[23]*y[73]*y[89]);
y[117]=lambda*MYI*x0*y[3]*y[6]*y[86]*y[102];
y[118]=y[116]+y[117];
y[119]=-(lambda*MYI*x2*y[59]*y[69]*y[86]*y[118]);
y[120]=pow(y[89],2);
y[121]=x0*x1*y[3]*y[6]*y[13]*y[14]*y[23]*y[120];
y[122]=y[99]*y[102];
y[123]=y[121]+y[122];
y[124]=-2.*lambda*MYI*x1*x2*y[4]*y[5]*y[39]*y[59]*y[69];
y[125]=lambda*MYI*x2*y[59]*y[104];
y[126]=1.+y[105]+y[124]+y[125];
y[127]=y[123]*y[126];
y[128]=y[115]+y[119]+y[127];
y[129]=y[5]*y[107];
y[130]=y[5]*y[109];
y[131]=y[5]*y[107]*y[109];
y[132]=-(lambda*MYI*x2*y[59]*y[69]*y[104]);
y[133]=x2+y[132];
y[134]=y[5]*y[107]*y[109]*y[133];
y[135]=y[5]+y[129]+y[130]+y[131]+y[134];
y[136]=pow(y[135],-2);
y[137]=pow(y[107],2);
FOUT=0.5*pow(y[21],2)*y[1]*y[33]*y[38]-y[21]*y[64]-y[22]*y[64]+0.5*(y[1]*(9.\
*pow(y[45],2)*y[33]*y[38]+4.*pow(y[52],2)*y[33]*y[38]-12.*y[33]*y[38]*y[45]\
*y[52])+2.*(3.*y[33]*y[38]*y[45]-2.*y[33]*y[38]*y[52])*(y[1]*y[62]+y[65]+y[\
66])+y[33]*y[38]*(pow(y[40],2)*y[1]+pow(y[43],2)*y[1]+pow(y[62],2)*y[1]-2.*\
y[1]*y[40]*y[43]+2.*y[62]*(y[65]+y[66])))+y[1]*y[33]*y[38]*(y[21]*y[22]-y[2\
2]*y[67])+y[1]*(-(y[21]*y[22])+y[22]*y[67])*y[111]*y[128]*y[136]+y[22]*(-(m\
yLog(1.+y[100])*y[1]*y[111]*y[128]*y[136])+myLog(y[110])*y[1]*y[111]*y[128]\
*y[136]+3.*myLog(y[135])*y[1]*y[111]*y[128]*y[136]-2.*myLog(y[7]+y[10]+y[4]\
*y[5]*y[107]-y[5]*y[9]*y[107]+y[4]*y[5]*y[109]+y[4]*y[5]*y[107]*y[109]+y[4]\
*y[5]*y[107]*y[133]+2.*y[4]*y[5]*y[107]*y[109]*y[133]-y[5]*y[9]*y[107]*y[10\
9]*y[133]+pow(y[133],2)*y[4]*y[5]*y[109]*y[137]+y[4]*y[5]*y[133]*y[137]+y[4\
]*y[5]*y[109]*y[133]*y[137])*y[1]*y[111]*y[128]*y[136]+y[1]*y[40]*y[111]*y[\
128]*y[136]);
return (FOUT);
}
