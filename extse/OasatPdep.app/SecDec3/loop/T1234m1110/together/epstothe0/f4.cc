#include "intfile.hh"

dcmplx Pf4(const double x[], double es[], double esx[], double em[], double lambda, double lrs[], double bi) {
double x0=x[0];
double x1=x[1];
double x2=x[2];
dcmplx y[79];
dcmplx FOUT;
dcmplx MYI(0.,1.);
y[1]=1./bi;
y[2]=em[0];
y[3]=-x0;
y[4]=1.+y[3];
y[5]=2.*y[1]*y[2];
y[6]=lrs[0];
y[7]=2.*x0*y[1]*y[2];
y[8]=2.*x1*y[1]*y[2];
y[9]=esx[0];
y[10]=-(y[1]*y[9]);
y[11]=2.*x0*x1*y[1]*y[2];
y[12]=-(x1*y[1]*y[9]);
y[13]=y[5]+y[7]+y[8]+y[10]+y[11]+y[12];
y[14]=-x1;
y[15]=1.+y[14];
y[16]=lrs[1];
y[17]=y[1]*y[2];
y[18]=x0*x0;
y[19]=y[1]*y[2]*y[18];
y[20]=-(x0*y[1]*y[9]);
y[21]=y[7]+y[17]+y[19]+y[20];
y[22]=-(lambda*MYI*x0*y[4]*y[6]*y[13]);
y[23]=x0+y[22];
y[24]=-(lambda*MYI*x1*y[15]*y[16]*y[21]);
y[25]=x1+y[24];
y[26]=pow(bi,-2);
y[27]=lambda*lambda;
y[28]=y[5]+y[7]+y[10];
y[29]=pow(y[28],2);
y[30]=x0*x1*y[4]*y[6]*y[15]*y[16]*y[27]*y[29];
y[31]=y[5]+y[8];
y[32]=-(lambda*MYI*x0*y[4]*y[6]*y[31]);
y[33]=-(lambda*MYI*y[4]*y[6]*y[13]);
y[34]=lambda*MYI*x0*y[6]*y[13];
y[35]=1.+y[32]+y[33]+y[34];
y[36]=-(lambda*MYI*y[15]*y[16]*y[21]);
y[37]=lambda*MYI*x1*y[16]*y[21];
y[38]=1.+y[36]+y[37];
y[39]=y[35]*y[38];
y[40]=y[30]+y[39];
y[41]=y[1]*y[23];
y[42]=y[1]*y[25];
y[43]=y[1]*y[23]*y[25];
y[44]=y[1]+y[41]+y[42]+y[43];
y[45]=pow(y[44],-2);
y[46]=pow(y[23],2);
y[47]=1./x2;
y[48]=x0*y[1]*y[2];
y[49]=-(x0*x1*y[1]*y[9]);
y[50]=lrs[2];
y[51]=-x2;
y[52]=1.+y[51];
y[53]=2.*x2*y[1]*y[2];
y[54]=y[5]+y[7]+y[20]+y[53];
y[55]=2.*x1*x2*y[1]*y[2];
y[56]=x2*y[1]*y[2];
y[57]=-(x1*x2*y[1]*y[9]);
y[58]=y[5]+y[7]+y[8]+y[10]+y[11]+y[12]+y[55]+y[56]+y[57];
y[59]=y[8]+y[12]+y[17];
y[60]=-(x2*y[1]*y[9]);
y[61]=y[5]+y[7]+y[10]+y[53]+y[60];
y[62]=2.*x0*x2*y[1]*y[2];
y[63]=x2*x2;
y[64]=y[1]*y[2]*y[63];
y[65]=-(x0*x2*y[1]*y[9]);
y[66]=y[7]+y[17]+y[19]+y[20]+y[53]+y[62]+y[64]+y[65];
y[67]=-(lambda*MYI*y[4]*y[6]*y[58]);
y[68]=lambda*MYI*x0*y[6]*y[58];
y[69]=1.+y[32]+y[67]+y[68];
y[70]=-(lambda*MYI*y[15]*y[16]*y[66]);
y[71]=lambda*MYI*x1*y[16]*y[66];
y[72]=1.+y[70]+y[71];
y[73]=y[8]+y[11]+y[17]+y[48]+y[49]+y[55];
y[74]=-(lambda*MYI*y[50]*y[52]*y[73]);
y[75]=-(lambda*MYI*x0*y[4]*y[6]*y[58]);
y[76]=x0+y[75];
y[77]=-(lambda*MYI*x1*y[15]*y[16]*y[66]);
y[78]=x1+y[77];
FOUT=myLog(bi)*y[26]*y[40]*y[45]+3.*myLog(y[44])*y[26]*y[40]*y[45]-2.*myLog(\
y[17]+2.*y[1]*y[2]*y[23]-y[1]*y[9]*y[23]+y[1]*y[2]*y[25]+2.*y[1]*y[2]*y[23]\
*y[25]-y[1]*y[9]*y[23]*y[25]+y[1]*y[2]*y[46]+y[1]*y[2]*y[25]*y[46])*y[26]*y\
[40]*y[45]+myLog(1.-lambda*MYI*(y[8]+y[11]+y[17]+y[48]+y[49])*y[50])*y[26]*\
y[40]*y[45]-y[26]*y[40]*y[45]*y[47]+(pow(y[1]+y[1]*y[76]+y[1]*y[78]+y[1]*(x\
2-lambda*MYI*x2*y[50]*y[52]*y[73])*y[78]+y[1]*y[76]*y[78],-2)*y[26]*y[47]*(\
lambda*MYI*x2*y[50]*y[52]*y[54]*(x0*x1*y[4]*y[6]*y[15]*y[16]*y[27]*y[59]*y[\
61]-lambda*MYI*x1*y[15]*y[16]*y[54]*y[69])-lambda*MYI*x2*y[50]*y[52]*y[59]*\
(-(x0*x1*y[4]*y[6]*y[15]*y[16]*y[27]*y[54]*y[61])+lambda*MYI*x0*y[4]*y[6]*y\
[59]*y[72])+(x0*x1*pow(y[61],2)*y[4]*y[6]*y[15]*y[16]*y[27]+y[69]*y[72])*(1\
.-2.*lambda*MYI*x1*x2*y[1]*y[2]*y[50]*y[52]+lambda*MYI*x2*y[50]*y[73]+y[74]\
)))/(1.+y[74]);
return (FOUT);
}
