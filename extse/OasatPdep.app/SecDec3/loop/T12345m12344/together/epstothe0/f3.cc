#include "intfile.hh"

dcmplx Pf3(const double x[], double es[], double esx[], double em[], double lambda, double lrs[], double bi) {
double x0=x[0];
double x1=x[1];
double x2=x[2];
double x3=x[3];
dcmplx y[180];
dcmplx FOUT;
dcmplx MYI(0.,1.);
y[1]=1./bi;
y[2]=em[1];
y[3]=em[3];
y[4]=esx[0];
y[5]=em[0];
y[6]=y[1]*y[5];
y[7]=y[1]*y[2];
y[8]=x0*y[1]*y[2];
y[9]=2.*x2*y[1]*y[2];
y[10]=em[2];
y[11]=x0*y[1]*y[10];
y[12]=x0*y[1]*y[3];
y[13]=2.*x0*x1*y[1]*y[3];
y[14]=2.*x0*x3*y[1]*y[3];
y[15]=-(y[1]*y[4]);
y[16]=x2*y[1]*y[2];
y[17]=y[1]*y[10];
y[18]=2.*x0*y[1]*y[10];
y[19]=x2*y[1]*y[10];
y[20]=y[1]*y[3];
y[21]=2.*x1*y[1]*y[3];
y[22]=4.*x0*x1*y[1]*y[3];
y[23]=x2*y[1]*y[3];
y[24]=2.*x1*x2*y[1]*y[3];
y[25]=2.*x3*y[1]*y[3];
y[26]=4.*x0*x3*y[1]*y[3];
y[27]=2.*x2*x3*y[1]*y[3];
y[28]=-x1;
y[29]=1.+y[28];
y[30]=-(x0*y[1]*y[4]);
y[31]=x0*x0;
y[32]=-x0;
y[33]=1.+y[32];
y[34]=lrs[0];
y[35]=x1*x1;
y[36]=x3*x3;
y[37]=-(x1*x2*y[1]*y[4]);
y[38]=-(x3*y[1]*y[4]);
y[39]=x1*y[1]*y[5];
y[40]=x3*y[1]*y[5];
y[41]=x1*x2*y[1]*y[2];
y[42]=x2*x3*y[1]*y[2];
y[43]=x1*y[1]*y[10];
y[44]=2.*x0*x1*y[1]*y[10];
y[45]=x1*x2*y[1]*y[10];
y[46]=x3*y[1]*y[10];
y[47]=2.*x0*x3*y[1]*y[10];
y[48]=x2*x3*y[1]*y[10];
y[49]=x1*y[1]*y[3];
y[50]=y[1]*y[3]*y[35];
y[51]=2.*x0*y[1]*y[3]*y[35];
y[52]=x1*x2*y[1]*y[3];
y[53]=x2*y[1]*y[3]*y[35];
y[54]=x3*y[1]*y[3];
y[55]=2.*x1*x3*y[1]*y[3];
y[56]=4.*x0*x1*x3*y[1]*y[3];
y[57]=x2*x3*y[1]*y[3];
y[58]=2.*x1*x2*x3*y[1]*y[3];
y[59]=y[1]*y[3]*y[36];
y[60]=2.*x0*y[1]*y[3]*y[36];
y[61]=x2*y[1]*y[3]*y[36];
y[62]=-(x1*x3*y[1]*y[4]);
y[63]=-2.*x0*x1*x3*y[1]*y[4];
y[64]=-(x1*x2*x3*y[1]*y[4]);
y[65]=y[17]+y[19]+y[37]+y[38]+y[39]+y[40]+y[41]+y[42]+y[43]+y[44]+y[45]+y[46\
]+y[47]+y[48]+y[49]+y[50]+y[51]+y[52]+y[53]+y[54]+y[55]+y[56]+y[57]+y[58]+y\
[59]+y[60]+y[61]+y[62]+y[63]+y[64];
y[66]=lrs[1];
y[67]=-x2;
y[68]=1.+y[67];
y[69]=-(x1*y[1]*y[4]);
y[70]=lambda*lambda;
y[71]=2.*x0*y[1]*y[3];
y[72]=2.*y[1]*y[3]*y[31];
y[73]=2.*x0*x2*y[1]*y[3];
y[74]=-(y[1]*y[4]*y[31]);
y[75]=-(x0*x2*y[1]*y[4]);
y[76]=y[30]+y[71]+y[72]+y[73]+y[74]+y[75];
y[77]=-(x2*y[1]*y[4]);
y[78]=-2.*x0*x3*y[1]*y[4];
y[79]=-(x2*x3*y[1]*y[4]);
y[80]=y[6]+y[16]+y[17]+y[18]+y[19]+y[20]+y[21]+y[22]+y[23]+y[24]+y[25]+y[26]\
+y[27]+y[38]+y[77]+y[78]+y[79];
y[81]=-2.*x0*x1*y[1]*y[4];
y[82]=y[6]+y[15]+y[16]+y[17]+y[18]+y[19]+y[20]+y[21]+y[22]+y[23]+y[24]+y[25]\
+y[26]+y[27]+y[37]+y[69]+y[81];
y[83]=-(x0*x3*y[1]*y[4]);
y[84]=x0*y[1]*y[5];
y[85]=x2*y[1]*y[5];
y[86]=x0*x2*y[1]*y[2];
y[87]=x2*x2;
y[88]=y[1]*y[2]*y[87];
y[89]=y[1]*y[10]*y[31];
y[90]=x0*x2*y[1]*y[10];
y[91]=2.*x1*y[1]*y[3]*y[31];
y[92]=x0*x2*y[1]*y[3];
y[93]=2.*x0*x1*x2*y[1]*y[3];
y[94]=2.*x3*y[1]*y[3]*y[31];
y[95]=2.*x0*x2*x3*y[1]*y[3];
y[96]=-(x3*y[1]*y[4]*y[31]);
y[97]=-(x0*x2*x3*y[1]*y[4]);
y[98]=y[6]+y[11]+y[12]+y[13]+y[14]+y[16]+y[75]+y[77]+y[83]+y[84]+y[85]+y[86]\
+y[88]+y[89]+y[90]+y[91]+y[92]+y[93]+y[94]+y[95]+y[96]+y[97];
y[99]=lrs[2];
y[100]=-(x0*x1*y[1]*y[4]);
y[101]=y[6]+y[7]+y[8]+y[9]+y[11]+y[12]+y[13]+y[14]+y[15]+y[100];
y[102]=2.*x1*y[1]*y[10];
y[103]=2.*x3*y[1]*y[10];
y[104]=2.*y[1]*y[3]*y[35];
y[105]=4.*x1*x3*y[1]*y[3];
y[106]=2.*y[1]*y[3]*y[36];
y[107]=-2.*x1*x3*y[1]*y[4];
y[108]=y[102]+y[103]+y[104]+y[105]+y[106]+y[107];
y[109]=-(lambda*MYI*x0*y[33]*y[34]*y[108]);
y[110]=-(lambda*MYI*y[33]*y[34]*y[65]);
y[111]=lambda*MYI*x0*y[34]*y[65];
y[112]=1.+y[109]+y[110]+y[111];
y[113]=y[71]+y[72]+y[73];
y[114]=-(lambda*MYI*x1*y[29]*y[66]*y[113]);
y[115]=-(lambda*MYI*y[29]*y[66]*y[98]);
y[116]=lambda*MYI*x1*y[66]*y[98];
y[117]=1.+y[114]+y[115]+y[116];
y[118]=-x3;
y[119]=1.+y[118];
y[120]=x1*y[1]*y[2];
y[121]=x3*y[1]*y[2];
y[122]=y[17]+y[43]+y[46]+y[49]+y[50]+y[54]+y[55]+y[59]+y[62]+y[69]+y[120]+y[\
121];
y[123]=y[6]+y[7]+y[8]+y[9]+y[11]+y[12]+y[13]+y[14]+y[15]+y[30]+y[83];
y[124]=x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[80]*y[82];
y[125]=-(lambda*MYI*x1*y[29]*y[66]*y[76]*y[112]);
y[126]=y[124]+y[125];
y[127]=x0*x1*y[1]*y[2];
y[128]=2.*x1*x2*y[1]*y[2];
y[129]=x0*x3*y[1]*y[2];
y[130]=2.*x2*x3*y[1]*y[2];
y[131]=x0*x1*y[1]*y[10];
y[132]=x0*x3*y[1]*y[10];
y[133]=x0*x1*y[1]*y[3];
y[134]=x0*y[1]*y[3]*y[35];
y[135]=x0*x3*y[1]*y[3];
y[136]=2.*x0*x1*x3*y[1]*y[3];
y[137]=x0*y[1]*y[3]*y[36];
y[138]=-(x0*x1*x3*y[1]*y[4]);
y[139]=y[6]+y[7]+y[9]+y[11]+y[15]+y[38]+y[39]+y[40]+y[69]+y[100]+y[120]+y[12\
1]+y[127]+y[128]+y[129]+y[130]+y[131]+y[132]+y[133]+y[134]+y[135]+y[136]+y[\
137]+y[138];
y[140]=lrs[3];
y[141]=x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[82]*y[123];
y[142]=-(x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[76]*y[122]);
y[143]=y[141]+y[142];
y[144]=-(x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[76]*y[80]);
y[145]=lambda*MYI*x0*y[33]*y[34]*y[82]*y[117];
y[146]=y[144]+y[145];
y[147]=2.*y[1]*y[2];
y[148]=2.*x1*y[1]*y[2];
y[149]=2.*x3*y[1]*y[2];
y[150]=y[147]+y[148]+y[149];
y[151]=-(lambda*MYI*x2*y[68]*y[99]*y[150]);
y[152]=-(lambda*MYI*y[68]*y[99]*y[139]);
y[153]=lambda*MYI*x2*y[99]*y[139];
y[154]=1.+y[151]+y[152]+y[153];
y[155]=x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[80]*y[122];
y[156]=-(lambda*MYI*x1*y[29]*y[66]*y[112]*y[123]);
y[157]=y[155]+y[156];
y[158]=-(x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[80]*y[123]);
y[159]=lambda*MYI*x0*y[33]*y[34]*y[117]*y[122];
y[160]=y[158]+y[159];
y[161]=pow(y[80],2);
y[162]=x0*x1*y[29]*y[33]*y[34]*y[66]*y[70]*y[161];
y[163]=y[112]*y[117];
y[164]=y[162]+y[163];
y[165]=-(x1*y[1]*y[4]*y[31]);
y[166]=-(x0*x1*x2*y[1]*y[4]);
y[167]=y[6]+y[11]+y[12]+y[13]+y[14]+y[16]+y[30]+y[77]+y[84]+y[85]+y[86]+y[88\
]+y[89]+y[90]+y[91]+y[92]+y[93]+y[94]+y[95]+y[100]+y[165]+y[166];
y[168]=-(lambda*MYI*x1*y[29]*y[66]*y[98]);
y[169]=x1+y[168];
y[170]=-(lambda*MYI*x2*y[68]*y[99]*y[139]);
y[171]=x2+y[170];
y[172]=-(lambda*MYI*x0*y[33]*y[34]*y[65]);
y[173]=x0+y[172];
y[174]=-(lambda*MYI*x3*y[119]*y[140]*y[167]);
y[175]=x3+y[174];
y[176]=pow(y[173],2);
y[177]=pow(y[169],2);
y[178]=pow(y[171],2);
y[179]=pow(y[175],2);
FOUT=(pow(bi,-2)*(-(lambda*MYI*x3*y[76]*y[119]*y[140]*(-(lambda*MYI*x2*y[68]\
*y[99]*y[122]*y[143])-y[126]*y[154]-lambda*MYI*x2*y[68]*y[99]*y[101]*y[157]\
))+lambda*MYI*x3*y[82]*y[119]*y[140]*(-(lambda*MYI*x2*y[68]*y[99]*y[123]*y[\
143])-y[146]*y[154]-lambda*MYI*x2*y[68]*y[99]*y[101]*y[160])+lambda*MYI*x3*\
y[101]*y[119]*y[140]*(lambda*MYI*x2*y[68]*y[99]*y[123]*y[126]-lambda*MYI*x2\
*y[68]*y[99]*y[122]*y[146]-lambda*MYI*x2*y[68]*y[99]*y[101]*y[164])+(lambda\
*MYI*x2*y[68]*y[99]*y[123]*y[157]-lambda*MYI*x2*y[68]*y[99]*y[122]*y[160]+y\
[154]*y[164])*(1.-lambda*MYI*x3*y[113]*y[119]*y[140]+lambda*MYI*x3*y[140]*y\
[167]-lambda*MYI*y[119]*y[140]*y[167])))/((y[1]+y[1]*y[169]+y[1]*y[171]+y[1\
]*y[169]*y[171]+y[1]*y[169]*y[173]+y[1]*y[175]+y[1]*y[171]*y[175]+y[1]*y[17\
3]*y[175])*(y[6]+y[1]*y[5]*y[169]+y[1]*y[2]*y[171]-y[1]*y[4]*y[171]+y[1]*y[\
5]*y[171]+y[1]*y[2]*y[169]*y[171]-y[1]*y[4]*y[169]*y[171]+y[1]*y[5]*y[169]*\
y[171]+y[1]*y[10]*y[173]+y[1]*y[3]*y[169]*y[173]+y[1]*y[5]*y[169]*y[173]+y[\
1]*y[10]*y[169]*y[173]+y[1]*y[10]*y[171]*y[173]+y[1]*y[2]*y[169]*y[171]*y[1\
73]+y[1]*y[3]*y[169]*y[171]*y[173]-y[1]*y[4]*y[169]*y[171]*y[173]+y[1]*y[10\
]*y[169]*y[171]*y[173]+y[1]*y[5]*y[175]+y[1]*y[2]*y[171]*y[175]-y[1]*y[4]*y\
[171]*y[175]+y[1]*y[5]*y[171]*y[175]+y[1]*y[3]*y[173]*y[175]-y[1]*y[4]*y[17\
3]*y[175]+y[1]*y[5]*y[173]*y[175]+y[1]*y[10]*y[173]*y[175]+2.*y[1]*y[3]*y[1\
69]*y[173]*y[175]-y[1]*y[4]*y[169]*y[173]*y[175]+y[1]*y[2]*y[171]*y[173]*y[\
175]+y[1]*y[3]*y[171]*y[173]*y[175]+y[1]*y[10]*y[171]*y[173]*y[175]+2.*y[1]\
*y[3]*y[169]*y[171]*y[173]*y[175]-y[1]*y[4]*y[169]*y[171]*y[173]*y[175]+y[1\
]*y[10]*y[169]*y[176]+y[1]*y[10]*y[175]*y[176]+2.*y[1]*y[3]*y[169]*y[175]*y\
[176]-y[1]*y[4]*y[169]*y[175]*y[176]+y[1]*y[3]*y[173]*y[177]+y[1]*y[3]*y[17\
1]*y[173]*y[177]+y[1]*y[3]*y[176]*y[177]+y[1]*y[2]*y[178]+y[1]*y[2]*y[169]*\
y[178]+y[1]*y[2]*y[175]*y[178]+y[1]*y[3]*y[173]*y[179]+y[1]*y[3]*y[171]*y[1\
73]*y[179]+y[1]*y[3]*y[176]*y[179]));
return (FOUT);
}
